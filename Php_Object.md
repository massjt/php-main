## 对象基础

主要内容:

- 类和对象: 声明类及实例化对象
- 构造方法: 自动加载对象
- 基本数据类型和类的类型: 为什么类型很重要
- 继承: 为什么需要继承以及如何使用继承
- 可见性: 整合对象接口并保护类中的方法和属性不受干涉

### 类和对象

1. 理解类和对象之间奇妙的关系

类是用于生成对象的代码模板，使用`class`关键字和一个任意的类名来声明类。类名可以是任意数字和字母的组合，但不能以数字开头，和类关联的代码必须用大括号括起来。

对象是根据类中定义的模板所构造的数据，对象可以被说成是类的"实例"，生成对象需要`new`操作符。

```php
class ShopProduct {
    // 类体
}
$product1 = new ShopProduct();
$product2 = new ShopProduct();

// $product1 和 $product2是由同一个类生成的相同类型的不同对象
```

> 打个比方: 把类当做生产塑料鸭子的机器的一个铸模，那么对象就是这台机器生产的鸭子。物品的类型由它们压制出来的模具决定，看起来一样，但它们是不同的个体，即不同的实例。

在php脚本中创建的每个对象有唯一的身份，php会在一个进程内重复使用这些身份来访问这些对象。(通过打印对象可证明)

2. 设置类中的属性
> 类可定义被称为**属性**的特定变量，也加**成员变量**,用来存放对象之间互不相同的数据。

定义: 与标准变量相似，但必须在声明和赋值前加一个关键字，关键字决定了属性的作用域。

通过`->`字符连接对象变量和属性名来访问属性变量。

php没有强制所有的属性都要在类中声明，可动态的增加属性到对象，但这并不是一个好的做法，基本上不用。

如果对象具有在内部处理属性数据的能力，将会非常有利于编程，即可以使用方法.

3. 使用方法
> 属性可以让对象存储数据，类方法可以让对象执行任务

```php
public function myMethod ($argument, $another) {
    // ...
}
```

调用方法时，必须使用一对大括号(即使没有传递任何参数给该方法，类似于函数调用)

`$this` 伪变量把类指向一个对象实例，可以理解为 "当前实例"来替换`$this`

由于初始化时每次都要多行代码去赋值，过于麻烦，其次无法保证在初始化时对象每个属性都被设置了，因此需要一个当类实例化时可被自动调用的类方法，即构造方法。

**创建构造方法**

创建对象时，构造方法(也称为构造器)会被自动调用，通过方法`__construct()`实现

此时，实例化和设置只需一条语句就可完成，属性皆被初始化，在使用对象时，也该确定它的类型，即在声明方法时，可以强制规定参数的对象类型。

4. 参数和类型

**在面向对象开发中，"专注特定任务，忽略外界上下文"是一个重要的设计原则**

**一个类专注于处理一个任务**

**类型提示**

    将类名放在需要约束的方法参数之前

```php
public function write( ShopProduct $shopProduct) {
    // ...
}
// 有了参数的类型提示，就不再需要使用参数前对其进行类型检查
```

类型提示不能用于强制规定参数为某种基本数据类型，比如字符串和整型。如果要处理基本数据类型，则要使用如`is_int`这类的检查函数，但可以强制规定使用数组作为参数:

```php
function setArray( array $storearray ) {
    $this->array = $storearray;
}
```

5. 继承
> 继承是从一个基类得到一个或多个派生类的机制，继承的类称为**子类**，子类可以增加**父类**(也称超类)之外的新功能,因此子类也称为父类的“扩展”

继承可避免功能重复

使用继承:

```php
class CdProduct extends ShopProduct {

}
```
① 构造方法继承

```php 
class CdProduct extends ShopProduct {
    
    function __construct ($params) {
        parent::__construct();
        $this->xx = xx;
    }
}
```

② 直接覆盖
```php
class CdProduct extends ShopProduct {
    
    function getSummaryLine ($params) {
        $base = parent::getSummaryLine();
        $base .= "xxxxxx";;
        return $base;
    }
}
```

③ public、private、protected管理类的访问
> 类中的元素可以被声明为public、private或protected

    在任何地方都可以访问`public`属性

    只能在当前类或子类中访问`private`方法或属性，即使在子类中也不能访问

    可以在当前类或子类中访问`protected`方法或属性

用处: 可见性关键字允许我们只公开类中客户需要的部分，这给对象设置提供了一个清晰的接口

**访问方法: getter 和 setter**
> 客户端程序员需要使用类中保存的值时，通常比较好的做法是不要允许直接访问属性，而是提供方法来取得需要的值，称为访问方法，也称getter和setter

